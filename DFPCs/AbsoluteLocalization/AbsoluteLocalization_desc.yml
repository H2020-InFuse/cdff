name: AbsoluteLocalization
doc: Absolute localization that replies on orbital imagery and a Pointcloud and Orthoimage generated by the rover.
dfns:
    - name: PCTransform
    - name: Rasterizer
    - name: LocalFeatureExtraction
    - name: GlobalFeatureExtraction
    - name: FeatureMatching
    - name: PoseEstimator

input_ports:
    - name: lidarPC
      type: asn1SccPointcloud
      doc: "Point cloud for rover DEM generation"
      connections:
        - dfn: PCTransform
          port: readingPC
    - name: estimatedPose
      type: asn1SccTransformWithCovariance
      doc: "Estimated pose from localization"
      connections:
        - dfn: PCTransform
          port: guessPose
        - dfn: PoseEstimator
          port: prediction
# input ports in D5.2 are different in the description from the figure!
    - name: orthoImage
      type: asn1SccFrame
      doc: "Orthoimage frame"
      connections:
        - dfn: 
          port: 
    - name: orbitalImage
      type: asn1SccFrame
      doc: "Orbital image frame"
      connections:
        - dfn: 
          port: 

output_ports:
    - name: finalPose
      type: asn1SccTransformWithCovariance
      doc: "Final estimated absolute pose"
      connections:
          dfn: PoseEstimator
          port: finalPose

internal_connections:
    - from:
        dfn: PCTransform
        port: transformPC
      to:
        dfn: Rasterizer
        port: transformPC
    - from:
        dfn: Rasterizer
        port: localMap
      to:
        dfn: LocalFeatureExtraction
        port: localMap
    - from:
        dfn: LocalFeatureExtraction
        port: localFeatures
      to:
        dfn: FeatureMatching
        port: featuresSet1
    - from:
        dfn: GlobalFeatureExtraction
        port: globalFeatures
      to:
        dfn: FeatureMatching
        port: featuresSet2
    - from:
        dfn: FeatureMatching
        port: poseEstimate
      to:
        dfn: PoseEstimator
        port: observation
