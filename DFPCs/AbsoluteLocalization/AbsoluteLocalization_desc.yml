name: AbsoluteLocalization
doc: Absolute localization that replies on orbital imagery and a Pointcloud and Orthoimage generated by the rover.
dfns:
    - name: RockExtractor
    - name: LocalFeatureExtraction
    - name: GlobalFeatureExtraction
    - name: FeatureMatching
    - name: PoseEstimator

input_ports:
    - name: digitalElevationMap
      type: asn1SccMap
      doc: "Rover produced DEM"
      connections:
        - dfn: RockExtractor
          port: readingDEM
    - name: estimatedPose
      type: asn1SccTransformWithCovariance
      doc: "Estimated absolute pose"
      connections:
        - dfn: PoseEstimator
          port: prediction
    - name: orthoImage
      type: asn1SccFrame
      doc: "Orthoimage frame"
      connections:
        - dfn: LocalFeatureExtraction 
          port: readingOrtho
    - name: orbitalImage
      type: asn1SccFrame
      doc: "Orbital image frame"
      connections:
        - dfn: PoseEstimator
          port: readingOrbitalImage

output_ports:
    - name: finalPose
      type: asn1SccTransformWithCovariance
      doc: "Refined absolute pose"
      connections:
          dfn: PoseEstimator
          port: finalPose

internal_connections:
    - from: 
	dfn: RockExtractor
	port: extractedRocks
      to:
	dfn: PoseEstimator
	port: rockSet1
    - from:
        dfn: LocalFeatureExtraction
        port: localFeatures
      to:
        dfn: FeatureMatching
        port: featuresSet1
    - from:
        dfn: GlobalFeatureExtraction
        port: globalFeatures
      to:
        dfn: FeatureMatching
        port: featuresSet2
    - from:
        dfn: FeatureMatching
        port: poseEstimate
      to:
        dfn: PoseEstimator
        port: observation
